---
layout: layouts/post.njk
title: "'네모게임(NEMO GAME)': 100% 클리어 가능한 논리 퍼즐 개발기"
description: "무작위 생성의 함정을 피하고, 순수 웹 기술로 구현한 기하학 알고리즘과 타격감"
date: 2026-01-17
category: games
tags:
  - 게임개발
  - 알고리즘
  - 퍼즐
  - JavaScript
  - 기하학
---

> **게임 플레이하기**: [네모게임 바로가기 →](/playground/nemo-game/)

# [DevLog] '네모게임(NEMO GAME)': 100% 클리어 가능한 논리 퍼즐 개발기

**부제: 무작위 생성의 함정을 피하고, 순수 웹 기술로 구현한 기하학 알고리즘과 타격감**

## 1. 들어가는 말: 왜 또 퍼즐인가?

퍼즐 게임을 개발할 때 개발자가 마주하는 가장 큰 딜레마는 **"이 맵이 과연 풀릴까?"**입니다. 시중에 나와 있는 많은 캐주얼 퍼즐 게임들이 맵을 무작위(Random)로 생성한 뒤, 플레이어가 운이 나빠서 막히면 아이템을 쓰게 하거나 판을 섞어버립니다.

저는 이런 '운빨' 요소를 배제하고 싶었습니다. **"플레이어가 논리적으로 완벽하다면, 반드시 깰 수 있는 게임"**을 만드는 것이 목표였습니다. 그렇게 탄생한 것이 바로 HTML5, CSS3, Vanilla JavaScript로 제작된 **'네모게임(NEMO GAME)'**입니다.

이 글에서는 '네모게임'의 핵심인 **보장된 맵 생성 알고리즘**, **기하학적 좌표 계산법**, 그리고 웹에서도 콘솔 게임 같은 **타격감(Juice)을 구현한 과정**을 공유합니다.

---

## 2. 게임 규칙 및 핵심 메커니즘

'네모게임'의 규칙은 직관적입니다.

1. **스택(Stack) 구조**:  그리드에 블록들이 쌓여 있습니다. 위에서부터만 선택 가능합니다.
2. **사각형 매칭**: 같은 색 블록 4개를 선택해 **정사각형**을 만들면 사라집니다. (기울어진 마름모 형태도 가능)
3. **클리어 조건**: 모든 블록을 제거하면 승리합니다.

---

## 3. 핵심 알고리즘: "정답을 먼저 만들고 문제를 낸다"

가장 큰 기술적 도전은 **Deadlock(풀 수 없는 상태) 방지**였습니다. 블록을 무작위로 쌓으면, 밑에 깔린 블록이 필요한데 위에 다른 블록이 막고 있어 영원히 못 푸는 상황이 발생합니다.

이를 해결하기 위해 **역설계(Reverse Engineering) 생성 방식**을 도입했습니다.

### 3.1. 생성 프로세스 (Reverse Generation)

게임을 푸는 과정을 거꾸로 돌려서 맵을 생성합니다.

1. **빈 보드에서 시작**: 아무것도 없는  상태에서 시작합니다.
2. **좌표 선정**: 임의의 두 점 를 찍습니다.
3. **기하학적 계산**: 이 두 점을 변(또는 대각선)으로 하는 정사각형의 나머지 좌표 를 계산합니다.
4. **블록 푸시(Push)**: 계산된 4개의 좌표 $(P_1, P_2, P_3, P_4)$에 **같은 색 블록을 동시에 쌓습니다.**
5. **기록(History)**: 이 생성 순서를 배열에 `Stack`처럼 기록해둡니다.
6. **반복**: 목표 개수(Target Count)만큼 반복합니다.

이 방식으로 맵을 만들면, 플레이어는 생성된 순서의 **역순(LIFO)**으로 블록을 선택하기만 하면 수학적으로 **100% 클리어**가 가능해집니다. 즉, 이 게임은 '생성된 문제' 자체가 '해답의 경로'를 내포하고 있습니다.

### 3.2. 검증 시뮬레이션 (Simulation & Validation)

생성 후에는 혹시 모를 겹침 오류를 방지하기 위해, 내부적으로 **AI 시뮬레이션**을 돌립니다.

* 생성된 `History`를 역순으로 따라가며, 현재 보드 상태에서 해당 블록들이 **노출(Top)**되어 있는지 확인합니다.
* 만약 물리적으로 선택 불가능한 상황이 단 하나라도 발생하면, 해당 맵을 즉시 폐기하고 재생성합니다. (Retry Logic)

---

## 4. 수학적 로직: 기울어진 사각형 찾기

이 게임의 묘미는 반듯한 정사각형뿐만 아니라, **45도 혹은 기묘하게 기울어진 정사각형**도 인정된다는 점입니다. 이를 구현하기 위해 **벡터 회전**을 사용했습니다.

임의의 두 점 $A(x_1, y_1)$와 $B(x_2, y_2)$가 있을 때:

*
*

이 벡터 $(\Delta x, \Delta y)$를 90도 회전시키면 수직 벡터 $(-\Delta y, \Delta x)$를 얻을 수 있습니다. 이를 이용해 나머지 두 점을 찾습니다.

```javascript
// 두 점 p1, p3가 주어졌을 때 정사각형의 나머지 점 p2, p4 찾기
function getSquarePoints(p1, p3) {
    const dx = p3.c - p1.c;
    const dy = p3.r - p1.r;

    // 패리티 체크: 두 점 사이의 거리가 홀수라면 정수 좌표계에서 중심을 구할 수 없음
    // (Manhattan Distance의 합이 짝수여야 함)
    if ((Math.abs(dx) + Math.abs(dy)) % 2 !== 0) return null;

    // 중점 계산
    const midR = (p1.r + p3.r) / 2;
    const midC = (p1.c + p3.c) / 2;

    // 반(Half) 벡터 계산
    const hdx = dx / 2;
    const hdy = dy / 2;

    // 회전 변환을 통해 나머지 두 점 도출
    const p2 = { r: midR - hdx, c: midC + hdy };
    const p4 = { r: midR + hdx, c: midC - hdy };

    return [p1, p2, p3, p4];
}

```

이 코드를 통해 사용자가 어떤 두 점을 드래그하든, 그 사이를 잇는 유효한 정사각형이 존재하는지 $O(1)$에 가깝게 판별할 수 있습니다.

---

## 5. 힌트 알고리즘: 하이브리드 탐색

플레이어는 개발자가 의도한 '생성 역순'대로만 플레이하지 않습니다. 변칙적인 플레이를 할 경우, 생성 히스토리 기반의 힌트는 무용지물이 됩니다. 따라서 힌트 시스템은 두 단계로 작동합니다.

1. **Priority 1 (History Check)**: 생성 기록을 역순으로 탐색하여, 지금 당장 제거 가능한 '원래의 정답'이 있는지 확인합니다.
2. **Priority 2 (Brute Force)**: 플레이어가 순서를 비틀어버렸다면, 현재 보드에 노출된(Top) 모든 블록을 전수 조사하여 **'우연히 만들어진'** 정사각형이라도 찾아냅니다.

이 덕분에 힌트 버튼은 어떤 상황에서도 유효한 수를 찾아줍니다.

---

## 6. UX/UI & "The Juice" (타격감 구현)

웹 게임은 자칫 밋밋해 보일 수 있습니다. 게임의 손맛, 즉 **'Juice'**를 살리기 위해 다음과 같은 효과를 적용했습니다.

### 6.1. 화면 흔들림 (Screen Shake)

블록이 터질 때 CSS Animation을 이용해 보드 전체를 흔들어 줍니다.

```css
@keyframes shake-anim {
    0% { transform: translate(0, 0); }
    25% { transform: translate(-3px, 3px); }
    /* ... 미세한 진동 좌표 ... */
    100% { transform: translate(0, 0); }
}

```

JS에서 정답 처리 시 `board.classList.add('shake')`를 호출하여 타격감을 줍니다.

### 6.2. 파티클 이펙트 (Particles)

블록이 사라지는 자리에 해당 색상의 작은 조각(div)들을 생성하고, CSS `transform`과 `opacity`를 이용해 사방으로 흩뿌린 뒤 DOM에서 제거합니다. 이는 별도의 Canvas 없이 DOM 조작만으로 구현하여 가볍게 만들었습니다.

### 6.3. 스택 인스펙터 (Stack Inspector)

가장 큰 UX 문제는 "겹쳐진 블록 아래에 뭐가 있는지 안 보인다"는 것이었습니다. 이를 해결하기 위해 마우스를 올리면(Hover), 해당 칸의 블록 층을 **단면도처럼 보여주는 툴팁**을 제작했습니다. 툴팁의 크기를 키우고, 테두리를 강화하여 시인성을 높였습니다.

---

## 7. 마치며

**'네모게임'**은 단순한 아이디어에서 시작했지만, **'완전무결한 해결 가능성(Solvability)'**을 수학적으로 보장하기 위해 많은 고민이 들어간 프로젝트입니다.

* **기술 스택**: HTML5, CSS3, JavaScript (No Framework)
* **핵심 가치**: 논리적 완결성, 웹에서의 타격감 구현
* **교훈**: "랜덤은 쉽지만, 정교한 무작위는 어렵다." 역설계 방식은 퍼즐 게임 맵 생성의 훌륭한 대안이 됩니다.

이 게임이 퍼즐을 좋아하는 분들에게는 즐거운 도전을, 개발자 분들에게는 알고리즘적 영감을 주길 바랍니다.

---

**[네모게임 플레이하러 가기 →](/playground/nemo-game/)**

더 많은 인터랙티브 프로젝트는 [Playground](/playground/)에서 확인하세요.
